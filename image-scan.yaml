---
- name: Run Syft and Grype Test Commands
  hosts: all
  gather_facts: false

  tasks:
    - name: Get image SBOM
      ansible.builtin.shell:
        cmd: syft {{ survey_image }} --scope all-layers --file /tmp/syft-scan.json
      register: syft_output

    - name: Read output file
      ansible.builtin.command:
        cmd: cat /tmp/syft-scan.json
